---
import '@/styles/global.css';
import Layout from '@/layouts/Layout.astro';
import { fade } from 'astro:transitions';
import { Image } from 'astro:assets';

// interface Props {
//   frontmatter: {
//     title: string;
//     pubDate: string;
//     description: string;
//     author: string;
//     imageUrl?: string;
//     image_alt?: string;
//     videoUrl?: string;
//     project: string[];
//     tags: string[];
//   };
// }

const { frontmatter } = Astro.props;
const {
  title,
  pubDate,
  description,
  author,
  imageUrl,
  image_alt,
  videoUrl,
  project,
  tags,
} = frontmatter;

console.log(project.frontmatter);

function fixVideoURL(videoUrl: string) {
  if (videoUrl.includes('drive.google.com')) {
    return videoUrl.replace('view?usp=sharing', 'preview');
  } else if (videoUrl.includes('youtube.com')) {
    return videoUrl.replace('watch?v=', 'embed/');
  } else {
    return videoUrl;
  }
}
let fixedVideoURL;
if (videoUrl) {
  fixedVideoURL = fixVideoURL(videoUrl);
}
---

<Layout pageTitle={title} pageDescription={description}>
  <header class="">
    <p>Proyecto: <a href="">{project}</a></p>
    <p>Publicado el: {pubDate.slice(0, 10)}</p>
    <p transition:animate={fade({ duration: '2s' })}>
      <em>{description}</em>
    </p>
    <p>Escrito por: <a href="/about/">{author}</a></p>
    {
      fixedVideoURL && (
        <iframe
          src={fixedVideoURL}
          class="w-full aspect-video bg-gray-800 rounded border"
        />
      )
    }
    {
      imageUrl && (
        <img
          src={imageUrl}
          alt={image_alt ?? `Imagen de portada de ${title}`}
        />
      )
    }
  </header>
  <section class="content">
    <slot />
  </section>
  <style>
    .content {
      ul {
        list-style: disc;
      }
      li {
        margin: 0 2rem;
      }
      strong {
        color: var(--color-accent);
      }
    }
  </style>
</Layout>
