---
import { getCollection, getEntry } from 'astro:content';
import ProjectLayout from '@/layouts/ProjectLayout.astro';

export async function getStaticPaths() {
  const entries = await getCollection('projects');
  // console.log(entries);

  const paths = entries.map(page => {
    const [lang, ...slug] = page.slug.split('/');
    return { params: { lang, slug: slug.join('/') || undefined }, props: page };
  });

  return paths;
}

const { lang, slug } = Astro.params;
const page = Astro.props;
const formattedDate = page.data.date.toLocaleString(lang);

const { Content } = await page.render();
---

<ProjectLayout frontmatter={page.data} projectSlug={page.slug}>
  <Content />
</ProjectLayout>
